# CensoEscolarSaoPaulo
TCC IA - PUCMG

POSSIBILIDADES DE MACHINE LEARNING NO CENSO ESCOLAR DO MUNICÍPIO DE SÃO PAULO

# Scripts SQL para as Views que geraram os arquivos CSV tratados no trabalho

/*Cursou Ensino Médio - view cursouEnsinoMedio*/

SELECT PK_COD_ALUNO, COUNT(PK_COD_ALUNO) AS Expr1
FROM dbo.matricula_2008_2020
WHERE(TP_ETAPA_ENSINO IN (25, 30, 35)) 
AND (TP_ETAPA_ENSINO IS NOT NULL) 
AND (NU_ANO_CENSO BETWEEN 2009 AND 2017)
GROUP BY PK_COD_ALUNO

/*Cursou oitava série e o primeiro ano do ensino médio*/
SELECT oitava.[PK_COD_ALUNO]
	,dados.PK_COD_ALUNO
	,dados.TP_SEXO
	,dados.TP_COR_RACA
	,dados.TP_NACIONALIDADE   
	,dados.TP_DEPENDENCIA
	,CASE
		WHEN colegial.PK_COD_ALUNO is null THEN 0    
		ELSE 1
	END AS cursou_ensinomedio
FROM [dbo].[cursou_oitava] as oitava
Left join [dbo].[matricula_2008_2020] as dados
ON oitava.PK_COD_ALUNO = dados.PK_COD_ALUNO
Left join [dbo].[cursouEnsinoMedio] as colegial
ON oitava.PK_COD_ALUNO = colegial.PK_COD_ALUNO
GO)

/*Alunos ensino médio*/
SELECT oitava.[PK_COD_ALUNO]		
,Case WHEN tp_sexo=1 then 'M'
	else 'F'
	END as SEXO
,CASE WHEN TP_NACIONALIDADE = 1 THEN 'Brasileira' WHEN TP_NACIONALIDADE = 2 THEN 'Brasileira -nascido no exterior ou naturalizado' WHEN TP_NACIONALIDADE = 3 THEN 'Estrangeira' END AS NACIONALIDADE, 
    CASE WHEN TP_COR_RACA = 1 THEN 'Branca' WHEN TP_COR_RACA = 2 THEN 'Preta' WHEN TP_COR_RACA = 3 THEN 'Parda' WHEN TP_COR_RACA = 4 THEN 'Amarela' WHEN TP_COR_RACA = 5 THEN 'Indígena' ELSE 'Não declarada'
    END AS COR_RACA,
    CASE WHEN TP_DEPENDENCIA = 1 THEN 'Federal' WHEN TP_DEPENDENCIA = 2 THEN 'Estadual' WHEN TP_DEPENDENCIA = 3 THEN 'Municipal' WHEN TP_DEPENDENCIA = 4 THEN 'Privada' ELSE NULL 
    END AS DEPENDENCIA
	  ,CASE
    WHEN colegial.PK_COD_ALUNO is null THEN 0    
    ELSE 1
END AS cursou_ensinomedio
  FROM [dbo].[cursou_oitava] as oitava
  Left join [dbo].[matricula_2008_2020] as dados
  ON oitava.PK_COD_ALUNO = dados.PK_COD_ALUNO
  Left join [dbo].[cursouEnsinoMedio] as colegial
  ON oitava.PK_COD_ALUNO = colegial.PK_COD_ALUNO

/*Marticulas por etapas*/
SELECT NU_ANO_CENSO, PK_COD_MATRICULA, PK_COD_ALUNO, 
    CASE 
	WHEN TP_NACIONALIDADE = 1 THEN 'Brasileira' 
	WHEN TP_NACIONALIDADE = 2 THEN 'Brasileira -nascido no exterior ou naturalizado' 
	WHEN TP_NACIONALIDADE = 3 THEN 'Estrangeira' 
	END AS NACIONALIDADE, 
CASE WHEN TP_COR_RACA = 1 THEN 'Branca' 
	WHEN TP_COR_RACA = 2 THEN 'Preta' 
	WHEN TP_COR_RACA = 3 THEN 'Parda' 
	WHEN TP_COR_RACA = 4 THEN 'Amarela' 
	WHEN TP_COR_RACA = 5 THEN 'Indígena' 
	ELSE 'Não declarada'
	END AS COR_RACA,
	CASE WHEN TP_SEXO = 1 THEN 'M' 
	ELSE 'F' END AS SEXO, 
	CASE 
	WHEN TP_ETAPA_ENSINO = 1 THEN 'CRECHE' 
	WHEN TP_ETAPA_ENSINO IN (2) THEN 'PRÉ-ESCOLA' 
	WHEN TP_ETAPA_ENSINO IN (14) THEN '1° ANO - ENSINO FUNDAMENTAL' 
	WHEN TP_ETAPA_ENSINO IN (4, 15) THEN '2° ANO - ENSINO FUNDAMENTAL' 
	WHEN TP_ETAPA_ENSINO IN (5, 16)	THEN '3° ANO - ENSINO FUNDAMENTAL' 
	WHEN TP_ETAPA_ENSINO IN (6, 17) THEN '4° ANO - ENSINO FUNDAMENTAL' 
	WHEN TP_ETAPA_ENSINO IN (7, 18) THEN '5° ANO - ENSINO FUNDAMENTAL' 
	WHEN TP_ETAPA_ENSINO IN (8, 19) THEN '6° ANO - ENSINO FUNDAMENTAL' 
	WHEN TP_ETAPA_ENSINO IN (9, 20) THEN '7° ANO - ENSINO FUNDAMENTAL' 
	WHEN TP_ETAPA_ENSINO IN (10, 21) THEN '8° ANO - ENSINO FUNDAMENTAL' 
	WHEN TP_ETAPA_ENSINO IN (11, 41) 
	THEN '9° ANO - ENSINO FUNDAMENTAL' WHEN TP_ETAPA_ENSINO IN (25, 26, 27, 28, 29) THEN 'PROPEDÊUTICO - ENSINO MÉDIO' WHEN TP_ETAPA_ENSINO IN (35, 36, 37, 38) 
	THEN ' NORMAL OU MAGISTÉRIO- ENSINO MÉDIO' WHEN TP_ETAPA_ENSINO IN (30, 31, 32, 33, 34) THEN 'EDUCAÇÃO PROFISSIONAL - ENSINO MÉDIO' 
	ELSE NULL END AS ETAPA_ENSINO, 
	CASE WHEN TP_DEPENDENCIA = 1 THEN 'Federal' 
	WHEN TP_DEPENDENCIA = 2 THEN 'Estadual' 
	WHEN TP_DEPENDENCIA = 3 THEN 'Municipal' 
	WHEN TP_DEPENDENCIA = 4 THEN 'Privada' 
	ELSE NULL 
	END AS DEPENDENCIA,
	CO_ENTIDADE
FROM dbo.matricula_2008_2020

/*Agrupamento*/
SELECT NU_ANO_CENSO, DEPENDENCIA, CO_ENTIDADE, ETAPA_ENSINO, NACIONALIDADE, SEXO, COR_RACA, COUNT(PK_COD_MATRICULA) AS total
FROM dbo.matricula_por_etapa
WHERE(ETAPA_ENSINO IS NOT NULL)
GROUP BY NU_ANO_CENSO, DEPENDENCIA, CO_ENTIDADE, ETAPA_ENSINO, NACIONALIDADE, SEXO, COR_RACA
